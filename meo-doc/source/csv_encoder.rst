====================================
Кодировщик .csv :sup:`[csv_encoder]`
====================================

Утилита для изменения кодировки у .csv файлов, для корректного отображения при открытии в Microsoft Excel.

Скачивание
---------------

Для скачивания программы нажмите `[здесь] <_static/codes/csv_encoder.rar>`_

Если скачивания не произошло или архив оказался битым, то скачать утилиту можно следующим способом: 

Зайти в репозиторий `[csv_encoder] <https://github.com/remasik/csv_encoder>`_

Вам потребуется два файла: **encoder.py** и **encoder.bat**.

Скачать их можно кликнув по каждому из файлов левой кнопкой мыши, на открывшемся файле нажать кнопку **Raw** и комбинацией **ctrl+s** сохранить файлы в какой-нибудь папке. 

.. figure:: _static/images/1.png
       :scale: 300 %
       :align: center
       :alt: Кликаем на нужный файл


.. figure:: _static/images/2.png
       :scale: 300 %
       :align: center
       :alt: Кликаем на кнопку Raw


.. figure:: _static/images/3.png
       :scale: 300 %
       :align: center
       :alt: Скачиваем файл


.. figure:: _static/images/4.png
       :scale: 300 %
       :align: center
       :alt: Сохраняем в папке



Установка
---------------

Для работы приложения требуется установленный Python 2.7.x.

Если его нет, то заходим на `[официальный сайт] <https://www.python.org/downloads/>`_ . Скачиваем текущую версию Python 2.7.x

.. warning:: Убедитесь, что скачиваете Python версии **2**, а не **3**

После загрузки запускаем установщик и следуем инструкции.

.. hint:: В установщике возможно нужно будет выбрать **Выборочная установка** или **Custom**, для того, чтобы указать путь установки.

.. warning:: Важно, чтобы путь установки был в корень диска С, то есть путь должен выглядеть так: **C:\\Python27**. Если вы не уверены, что сможете это сделать, позовите того, кто сможет. 

Следующим шагом необходимо скачать модифицированный Python `[здесь] <_static/codes/Python27.rar>`_, распаковать его и слить с оригинальным.

Для этого нужно открыть файловый менеджер и зайти в корень диска **C:\\**. 

.. hint:: Зайти в Пуск -> Компьютер -> Локальный диск (C:)

Архив **Python27.rar** распаковываем на рабочий стол.

После чего перетащить распакованную папку **Python27** в корень диска **C:\\** и на все предложения о замене файлов и слиянии папок нужно **согласиться**, предварительно поставив галочки типа *сделать это для всех файлов и папок*, чтобы компьютер сделал слияние сам.

Использование
---------------

Для запуска утилиты кликните дважды на файл **encoder.bat**. Нажмите кнопку **Выбрать CSV файл**, откроется диалоговое окно файлового менеджера, где предлагается выбрать файл, который нужно перекодировать. 

Когда найдете файл и выделите его **однократным нажатием левой кнопкой мыши** нажмите кнопку **Открыть**. Как только в окне программы появится надпись **Файл открыт успешно** можно начинать кодирование. 

Для этого нажмите кнопку **Кодировать**. Если все пройдет успешно, то откроется диалоговое окно файлового менеджера для сохранения уже исправленного файла. Необходимо указать место сохранения и его имя.

Ошибки
---------------

В случае появления ошибок рекомендуется обратится к разработчику. Если ошибка появится в диалоговом окне с надписью, что ее необходимо отправить разработчику, то текст ошибки можно просто отправить по электронной почте или в скайп. В случае же, если программа просто не открывается или ведет себя странно и ничего не делает, лучше обратится к разработчику.

.. hint:: Контактные данные разработчика находятся на главной странице. Для того, чтобы перейти туда, необходимо кликнуть на логотип в верхнем левом углу.


Для продвинутых
----------------

Программа может работать неправильно, если встречает символы, которые не знает как обрабатывать, в окне с ошибкой, они выглядят примерно так: **\u25a1**, **\u0306**, **\xe9** и тд. В случае, если вы поймали именно эту ошибку, вы можете исправить ее самостоятельно, добавив исключение в код программы.

Для этого нужно скопировать код этого символа и открыть исходный код программы, то есть файла **encoder.py**.

Найти 94 строку, где написано:

.. code-block:: python

    replacers = [u'\u25a1',
                 u'\u0306',
                 u'\xe9',]

И добавить в список проблемный символ по аналогии.

.. code-block:: python

    replacers = [u'\u25a1',
                 u'\u0306',
                 u'\xe9',
                 u'\u3452',]

После чего сохранить изменения и выполнить повторно.